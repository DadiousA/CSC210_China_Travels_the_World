<html>
  <head>
    <title>Wan'U</title>
    <style type="text/css">
      img {
        height: 350;
        width: 350;
      }
      #header {
        color: black;
        font-size: 50px;
        font-family: "Lucida Console";
      }
      i{
        font-size: 70px;
        font-family: "Verdana";
        font-style: normal;
        font-weight: bold;
      }
    </style>
    <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>

    <script type="text/javascript">

      $(document).ready(function() {
      var user =readCookie('user');
      console.log("start");
        $.ajax({
            url: "user_pref/"+user,
            type: "GET",
            dataType : "json",

            success: function( data ) {
              console.log("data here:"+data);  
              console.log(data.language);  
              $("#language").val(data.language);
              $("#city").val(data.city);
            },
          });

        // readMe Cookie
        function readCookie(name) {
          var nameEQ = name + "=";
          var ca = document.cookie.split(';');
          for(var i=0;i < ca.length;i++) {
            var c = ca[i];
            while (c.charAt(0)==' ') c = c.substring(1,c.length);
            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
          }
          return null;
        };

        $("#time").html("The current time is " + new Date()+'.');
        setInterval(function(){$("#time").html("The current time is " + new Date()+'.');}, 1000);

        $("#header").html("Welcome back, <i>" +user+'</i>.');


        $( ".form-group" ).focusout(function() {
        //alert("The text has been changed.");
          $.ajax({
            url: "user_pref/",
            type: "POST",
            dataType : "text",

            data : {  name: readCookie('user'),
                      language: $("#language").val(),
                      city: $("#city").val(),
                    },
            success: function( data ) {
              console.log(data);
            },
          });
        });
/*
        $( "#city" ).focusout(function() {
        //alert("The text has been changed.");
          $.ajax({
            url: "user_pref/",
            type: "POST",
            dataType : "text",

            data : {  name: readCookie('user'),
                      city: $("#city").val(),
                    },
            success: function( data ) {
              console.log(data);
              if (data == 'City updated') {
                console.log("updated");
              } 
              else {
              }
            },
          });
        });
*/

      });

    </script>
  </head>
  
  <body>
    <h1 id='header'>Welcome</h1>
    
    <div>
      <p id="blog">My Album:</p>
      <img src="istanbul.jpg"/></li>
      <img src="jerusalem.jpg"/></li>
    </div>
    <form action="/image/"+userName method="post" enctype="multipart/form-data">
    <input type="file" name="add"/>  </form>
    <div id='time'></div>

    <div class="container">
      <h2>Personal Preferences</h2>
      <div class="form-group">
        <label for="language">language:</label>
        <input type="text" class="form-control" id="language" placeholder="Enter language">
      </div>
      <div class="form-group">
        <label for="city">City:</label>
        <input type="text" class="form-control" id="city" placeholder="Enter city">
      </div>
    </div>
  </body>
</html>
<!--
/*placeholder="Enter language"
  $("#updateButton").click(function() {
    $.ajax({
      // The URL for the request - note the simple REST API!
      // all URLs are relative to http://localhost:3000/
      url: "users/" + $("#nameBox").val(),
      type: "PUT",
      dataType : "text", // this URL returns a plain text string, not JSON

      data : { job: $("#jobBox").val(),
               pet: $("#petBox").val()
             },

      success: function( data ) {
        console.log("You received some data!", data);
        if (data == 'OK') {
          $("#status").html("Successfully updated user");
        } else {
          $("#status").html("Error: could not update user");
        }
      },
    });
  });

  $("#deleteButton").click(function() {
    $.ajax({
      // The URL for the request - note the simple REST API!
      // all URLs are relative to http://localhost:3000/
      url: "users/" + $("#nameBox").val(),
      type: "DELETE",
      dataType : "text", // this URL returns a plain text string, not JSON

      success: function( data ) {
        console.log("You received some data!", data);
        if (data == 'OK') {
          $("#status").html("Successfully deleted!");
        } else {
          $("#status").html("Error: could not delete!");
        }
      },
    });
  });
  */

-->